<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- ÂÖºÂÆπÁßªÂä®ËÆæÂ§áÔºåËÆæÁΩÆËßÜÂè£ÂÆΩÂ∫¶Á≠â‰∫éËÆæÂ§áÂÆΩÂ∫¶ÔºåËÆæÁΩÆÂàùÂßãÁº©ÊîæÊØî‰æã‰∏∫1.0 -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="index.css">
        <link rel="stylesheet" href="inputnumber.css">
        <title>Ë¥≠Áâ©ËΩ¶</title>
    </head>
    <body>
    <div class="app-container" id="app">
        <!-- È°∂ÈÉ®banner -->
        <div class="banner-box"><img src="./wifi/10.jpg" alt="fruit"></div>
        <!-- Èù¢ÂåÖÂ±ëÂØºËà™ -->
        <div class="breadcrumb">
            <span>üè†</span>
            /
            <span>Ë¥≠Áâ©ËΩ¶</span>                
        </div>
        <!-- Ë¥≠Áâ©ËΩ¶ÂàóË°® -->
        <!-- v-if v-else Êù°‰ª∂Ê∏≤ÊüìÔºåÂ¶ÇÊûúÊ≤°ÊúâÊï∞ÊçÆÂàôÊòæÁ§∫Á©∫ËΩ¶ -->
        <div v-if="cartList.length > 0" class="main">
            <div class="table">
                <!-- Ë°®Â§¥ -->
                <div class="thead">
                    <div class="tr">
                        <div class="th">ÈÄâ‰∏≠</div>
                        <div class="th th-pic">ËßíËâ≤</div>
                        <div class="th">ÂêçÂ≠ó</div>
                        <div class="th">ÊîªÂáªÂäõ</div>
                        <div class="th num-th">Êö¥ÂáªÁéá(%)</div>
                        <div class="th">Êö¥Âáª‰º§ÂÆ≥(%)</div>
                        <div class="th">ÊúüÊúõ‰º§ÂÆ≥</div>
                        <div class="th">Êìç‰Ωú</div>
                    </div>
                </div>
                <!-- Ë∫´‰Ωì -->
                <!-- v-for Âæ™ÁéØÈÅçÂéÜÊ∏≤ÊüìÊï∞ÁªÑ -->
                <div  class="tbody">
                    <!-- v-bind ÁªëÂÆöclassËÆæÁΩÆÊù°‰ª∂ -->
                    <div class="tr" :class="{active: item.checked}" v-for="(item, index) in cartList" :key="item.id">
                        <!-- v-model ÁªëÂÆöÂ±ûÊÄß -->
                        <div class="td"><input type="checkbox" v-model="item.checked"></div>
                        <!-- v-bind ÁªëÂÆösrc -->
                        <div class="td td-pic"><img :src="item.pic" alt="fruit"></div>
                        <div class="td">{{item.name}}</div>
                        <div class="td">{{item.attract}}</div>
                        <div class="td">
                            <div class="my-input-number">
                                <!-- @clickÁÇπÂáªÂÆûÁé∞Êï∞ÈáèÂä†Âáè -->
                                <!-- disabled ÊòØ‰∏Ä‰∏™Âä®ÊÄÅÂ±ûÊÄßÁªëÂÆöÔºåÂÖÅËÆ∏‰Ω†Ê†πÊçÆË°®ËææÂºèÁöÑÁªìÊûúÂä®ÊÄÅËÆæÁΩÆHTMLÂÖÉÁ¥†ÁöÑÂ±ûÊÄß„ÄÇ -->
                                <button @click="reduceCount(index)" :disabled="item.count <= 1" class="decrease"> - </button>
                                <span class="my-input__inner">{{item.count}}</span>
                                <button @click="addCount(index)" class="increase"> + </button>
                            </div>
                            <div class="my-input-number">
                                <!-- @clickÁÇπÂáªÂÆûÁé∞Êï∞ÈáèÂä†Âáè -->
                                <!-- disabled ÊòØ‰∏Ä‰∏™Âä®ÊÄÅÂ±ûÊÄßÁªëÂÆöÔºåÂÖÅËÆ∏‰Ω†Ê†πÊçÆË°®ËææÂºèÁöÑÁªìÊûúÂä®ÊÄÅËÆæÁΩÆHTMLÂÖÉÁ¥†ÁöÑÂ±ûÊÄß„ÄÇ -->
                                <button @click="reduceCount2(index)" :disabled="item.count2 <= 1" class="decrease"> - </button>
                                <span class="my-input__inner">{{item.count2}}</span>
                                <button @click="addCount2(index)" class="increase"> + </button>
                            </div>
                        </div>
                        <div class="td">{{item.attract * item.count * (100+item.count2) * 0.0001}}</div>
                        <div @click="del(item.id)" class="td"><button>Âà†Èô§</button></div>
                    </div>
                </div>
            </div>
            <!-- Â∫ïÈÉ® -->
            <div class="bottom">
                <!-- ÂÖ®ÈÄâ -->
                <label class="checkedall">
                    <!-- v-model ÁªëÂÆöËÆ°ÁÆóÂ±ûÊÄßÔºåÂÆûÁé∞ÂÖ®ÈÄâÂäüËÉΩ -->
                    <input type="checkbox" v-model="allChecked">ÂÖ®ÈÄâ
                </label>
                <div class="right-box">
                    <!-- ÊâÄÊúâËßíËâ≤ÁöÑÊúüÊúõÊîªÂáªÂäõ‰πãÂíå -->
                    <span class="total-attack">ÊÄªÊàòÂäõÔºö{{totalAttack}}</span>
                    <!-- ÁªìÁÆóÊåâÈíÆ -->
                    <button class="pay">ÁªìÁÆó</button>
                </div>
            </div>
        </div>
        <!-- Á©∫ËΩ¶ -->
        <div v-else class="empty">üõíÁ©∫Á©∫Â¶Ç‰πü</div>
    </div>
    <script src="https://cdn.staticfile.net/vue/2.2.2/vue.min.js"></script>
    <script>
        const defultArr = [
            {
                id: 1,
                attract: 1000,
                count: 50,
                count2: 50,
                checked: true,
                name:"ÊµÅËê§",
                pic: './wifi/1.jpg'
            },
            {
                id: 2,
                attract: 2000,
                count: 60,
                count2: 60,
                checked: false,
                name:"ËäôÂÆÅÂ®ú",
                pic: './wifi/2.jpg'
            },
            {
                id: 3,
                attract: 3000,
                count: 70,
                count2: 70,
                checked: false,
                name:"‰∏âÊúà‰∏É",
                pic: './wifi/3.jpg'
            },
            {
                id: 4,
                attract: 4000,
                count: 80,
                count2: 80,
                checked: false,
                name:"ÈïúÊµÅ",
                pic: './wifi/4.jpg'
            },
            {
                id: 5,
                attract: 5000,
                count: 70,
                count2: 70,
                checked: false,
                name:"Èì∂Áãº",
                pic: './wifi/5.jpg'
            },
            {
                id: 6,
                attract: 6000,
                count: 60,
                count2: 60,
                checked: false,
                name:"ÁªÆËâØËâØ",
                pic: './wifi/6.jpg'
            },
            {
                id: 7,
                attract: 7000,
                count: 50,
                count2: 50,
                checked: false,
                name:"Áë∂Áë∂",
                pic: './wifi/7.jpg'
            },
            {
                id: 8,
                attract: 8000,
                count: 40,
                count2: 40,
                checked: false,
                name:"Â¶ÆÈú≤",
                pic: './wifi/8.jpg'
            },
        ]
        const app = new Vue({
            el: '#app',
            data: {
                // localStorge.getItem ÊòØ Web Storage API ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÁî®Êù•Ëé∑ÂèñÊú¨Âú∞Â≠òÂÇ®Âêç‰∏∫‚ÄòcartList‚ÄôÁöÑÂ≠òÂÇ®Êï∞ÊçÆ
                // JSON.parse ÂáΩÊï∞Áî®‰∫éÂ∞ÜJSONÊ†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢ÊàêJavaScriptÂØπË±°„ÄÇÂ¶ÇÊûú‰ªé localStorage Ëé∑ÂèñÁöÑÊòØÊúâÊïàÂ≠óÁ¨¶‰∏≤ÔºåÂ∞ÜË¢´ËΩ¨Êç¢‰∏∫ÂØπÂ∫îÁöÑJavaScriptÂØπË±°„ÄÇ
                // ||ÊòØÈÄªËæëËÆ°ÁÆóÁ¨¶ÔºåÂ¶ÇÊûúÂ∑¶‰æßÁªìÊûú‰∏∫nullÔºåÂàôËøîÂõûÂè≥‰æßÁªìÊûú„ÄÇ
                cartList: JSON.parse(localStorage.getItem('tList')) || defultArr,

            },
            computed:{
                // ËÆ°ÁÆóÂ±ûÊÄßÔºåËÆ°ÁÆóÊâÄÊúâËßíËâ≤ÁöÑÊúüÊúõÊîªÂáªÂäõ‰πãÂíå
                allChecked:{
                    // get Áî®‰∫éËé∑Âèñ
                    get(){
                        return this.cartList.every(item => item.checked)
                    },
                    // set Áî®‰∫éËÆæÁΩÆ
                    set(value){
                        // ÁÇπÂáªÊåâÈíÆÊó∂ÂÖàÂà§Êñ≠
                        // some() ÊñπÊ≥ïÂÆûÁé∞Â¶ÇÊûúÊúâ‰ªªÊÑè‰∏Ä‰∏™ÊåâÈíÆ‰∏çÊòØtrueÔºåÂàôÂÖ®ÈÄâÔºåÂèç‰πãÂèñÊ∂àÊâÄÊúâÈÄâÊã©
                        this.cartList.forEach(item => item.checked = value)
                    }
                },
                totalcount(){
                    return this.cartList.reduce((sum,item) => {
                        // Âà§Êñ≠ÂÆûÁé∞ÈÄâ‰∏≠Áä∂ÊÄÅÂÜçÊ∑ªÂä†
                        if (item.checked === true) {
                            return sum + item.num
                        } else {
                            // Ê≤°ÈÄâ‰∏≠Âàô‰∏çÊ∑ªÂä†
                            return sum
                        }
                    },0)
                },
                totalAttack(){
                    return this.cartList.reduce((sum,item) => {
                        // Âà§Êñ≠ÂÆûÁé∞ÈÄâ‰∏≠Áä∂ÊÄÅÂÜçÊ∑ªÂä†
                        if (item.checked === true) {
                            return sum + (item.attract * item.count * (100+item.count2) * 0.0001)
                        } else {
                            // Ê≤°ÈÄâ‰∏≠Âàô‰∏çÊ∑ªÂä†
                            return sum
                        }
                    },0)
                },     
            },
        methods: {

            reduceCount(index) {
                if (this.cartList[index].count > 1) {
                    this.cartList[index].count--;
                }
            },
            addCount(index) {
                this.cartList[index].count++;
            },
            reduceCount2(index) {
                if (this.cartList[index].count2 > 1) {
                    this.cartList[index].count2--;
                }
            },
            addCount2(index) {
                this.cartList[index].count2++;
            },
            del (id) {
                // ÁÇπÂáªÂà†Èô§ÊåâÈíÆÊó∂ÔºåÂ∞ÜÂØπÂ∫îidÁöÑÂØπË±°‰ªéÊï∞ÁªÑ‰∏≠ÁßªÈô§
                this.cartList = this.cartList.filter(item => item.id !== id)
            },
                // ÈáçÊñ∞Ê∏≤ÊüìÈ°µÈù¢
            updateLocalStorage() {
                localStorage.setItem('cartList', JSON.stringify(this.cartList));
            }
        },
        // ‰ΩøÁî®watchÁõëÂê¨cartListÊï∞ÁªÑÁöÑÂèòÂåñÔºåÂ∞ÜÊï∞ÁªÑÂ≠òÂÇ®Âà∞localStorageÔºåÂÆûÁé∞ÊåÅ‰πÖÂåñ
        watch:{
            // ÁõëÂê¨cartListÊï∞ÁªÑÁöÑÂèòÂåñÔºåÂ∞ÜÊï∞ÁªÑÂ≠òÂÇ®Âà∞localStorage
            cartList:{
                deep: true,
                handler(newValue){
                    this.$nextTick(() => {
                        localStorage.setItem('tList', JSON.stringify(newValue));
                    });
                }
            }
        }
    })


    </script>


    </body>

</html>